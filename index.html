<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Random Subset Generator</title>
    <style>
        body {
            background-color: black;
            color: white;
            font-family: 'Arial', sans-serif;
            text-align: center;
            padding: 50px;
        }

        h1 {
            color: gold;
        }

        button {
            background-color: gold;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            border-radius: 8px;
            margin: 10px;
        }

        button:hover {
            background-color: white;
            color: black;
        }

        .result {
            margin-top: 20px;
            overflow-x: auto;
        }

        table {
            margin: 0 auto;
            border-collapse: collapse;
            background-color: #333;
        }

        th, td {
            border: 1px solid gold;
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: gold;
            color: black;
        }

        #fileInput {
            margin: 20px;
        }

        .upload-section {
            margin: 20px 0;
        }

        .file-instruction {
            color: #888;
            font-size: 14px;
            margin-top: 5px;
        }
    </style>
</head>

<body>
    <h1>Random Subset Generator</h1>
    <div class="upload-section">
        <input type="file" id="fileInput" accept=".csv">
        <div class="file-instruction"> Please upload a .csv file containing the data</div>
    </div>
    <p>Enter the size of the subset:</p>
    <input type="number" id="subsetSize" min="1" value="#">
    <br>
    <button onclick="generateRandomSubset()">Generate Subset</button>
    <div class="result" id="resultDisplay"></div>

    <script>
        let previousSubset = null;
        let csvData = null;

        function rand(lower, higher) {
            return Math.floor(Math.random() * (higher - lower + 1)) + lower;
        }

        function arraysEqual(arr1, arr2) {
            if (!arr1 || !arr2) return false;
            if (arr1.length !== arr2.length) return false;
            return arr1.every((value, index) => value === arr2[index]);
        }

        document.getElementById('fileInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    csvData = parseCSV(event.target.result);
                };
                reader.readAsText(file);
            }
        });

        function parseCSV(csvText) {
            const lines = csvText.split('\n');
            const headers = lines[0].trim().split(',');
            const data = [];
            
            for (let i = 1; i < lines.length; i++) {
                const line = lines[i].trim();
                if (line) {
                    const values = line.split(',');
                    data.push({
                        Number1: parseFloat(values[0]),
                        Number2: parseFloat(values[1]),
                        String: values[2],
                        Boolean: values[3].toLowerCase() === 'true'
                    });
                }
            }
            return data;
        }

        function generateRandomSubset() {
            if (!csvData) {
                alert("Please upload a CSV file first!");
                return;
            }

            const subsetSize = parseInt(document.getElementById('subsetSize').value);

            if (isNaN(subsetSize) || subsetSize < 1 || subsetSize > csvData.length) {
                alert(`Please enter a valid subset size between 1 and ${csvData.length}`);
                return;
            }

            let subset;
            do {
                subset = [];
                const indices = new Set();
                while (indices.size < subsetSize) {
                    indices.add(rand(0, csvData.length - 1));
                }
                subset = Array.from(indices).map(index => csvData[index]);
            } while (arraysEqual(subset, previousSubset));

            previousSubset = subset;
            displayResult(subset);
        }

        function displayResult(subset) {
            const resultDiv = document.getElementById('resultDisplay');
            const table = document.createElement('table');
            
            const headerRow = document.createElement('tr');
            ['Number1', 'Number2', 'String', 'Boolean'].forEach(header => {
                const th = document.createElement('th');
                th.textContent = header;
                headerRow.appendChild(th);
            });
            table.appendChild(headerRow);

            subset.forEach(row => {
                const tr = document.createElement('tr');
                Object.values(row).forEach(value => {
                    const td = document.createElement('td');
                    td.textContent = typeof value === 'boolean' ? value.toString() : value;
                    tr.appendChild(td);
                });
                table.appendChild(tr);
            });

            resultDiv.innerHTML = '';
            resultDiv.appendChild(table);
        }
    </script>
</body>

</html>